{% extends "base.html" %}

{% block title %}Manage Data{% endblock %}
{% block content %}
<div class="manage-data-container">
  <div class="manage-data-header">
    <h1>Manage Data</h1>
  </div>
  <form method="post" id="tableForm">
    <select name="table" id="tableSelect" onchange="handleTableSelection()">
      <option value="">Select a table</option>
      {% for table_name in table_names %}
      <option value="{{ table_name }}">{{ table_name }}</option>
      {% endfor %}
    </select>
  </form>
  <div class="popup-form" id="popup-form-edit">
    <form class="form" method="post">
      <div class="form-container">
        <div><h1>Edit</h1></div>
        {% for column_name in column_names %}
        <div class="form-group">
          <label for="{{ column_name }}">{{ column_name }}:</label>
          <input type="text" name="{{ column_name }}" class="form-control" id="{{ column_name }}" placeholder="Enter {{ column_name }}">
        </div>
        {% endfor %}
        <div class="form-buttons">
          <button type="submit" class="btn btn-default" name="edit">Submit</button>
          <button type="button" class="btn btn-default" onclick="closeFormEdit()">Cancel</button>
        </div>
      </div>
    </form>
  </div>
  <div class="popup-form" id="popup-form-add">
    <form class="form" method="post">
      <div class="form-container">
        <div><h1>Add</h1></div>
        {% for column_name in column_names %}
        <div class="form-group">
          <label for="{{ column_name }}">{{ column_name }}:</label>
          <input type="text" name="{{ column_name }}" class="form-control" id="{{ column_name }}" placeholder="Enter {{ column_name }}">
        </div>
        {% endfor %}
        <div class="form-buttons">
          <button type="submit" class="btn btn-default" name="add">Submit</button>
          <button type="button" class="btn btn-default" onclick="closeFormAdd()">Cancel</button>
        </div>
      </div>
    </form>
  </div> 
  <div class="data-table">
    <div class="table-name">
      <h2>{{ table_name }}</h2>
    </div>
    <div class="table-controls">
      <div class="entries-per-page">
        <label for="entries">Show:</label>
        <select name="entries" id="entries">
          <option value="10">10</option>
          <option value="25">25</option>
          <option value="50">50</option>
          <option value="100">100</option>
        </select>
        <span>entries</span>
      </div>
      <div class="search-bar">
        <input type="text" id="search" name="search" placeholder="Search...">
        <button type="button" id="search-btn">Search</button>
      </div>
    </div>
    <div class="table">
      <table>
          <thead>
              <tr>
                  {% for column_name in column_names %}
                  <th>{{ column_name }}</th>
                  {% endfor %}
                  <th>Actions</th>
              </tr>
          </thead>
          <tbody>
              {% for row in rows %}
              <tr>
                  {% for value in row %}
                  <td>{{ value }}</td>
                  {% endfor %}
                  <td>
                      <a href="#" class="edit-btn">Edit</a>
                      <a href="#" class="delete-btn">Delete</a>
                  </td>
              </tr>
              {% endfor %}
          </tbody>
      </table>
  </div>
    <div class="table-controls">
      <a href="/manage-data/add-data/{{ table_name }}" class="add-btn" onclick="openFormAdd()">Add</a>
      <div>
        <button type="button" id="prev-btn">Previous</button>
        <button type="button" id="next-btn">Next</button>
      </div>
    </div>
  </div>
</div>
<script>
  function openFormEdit() {
    document.getElementById("popup-form-edit").style.display = "block";
  }

  function closeFormEdit() {
    document.getElementById("popup-form-edit").style.display = "none";
  }

  function openFormAdd() {
    document.getElementById("popup-form-add").style.display = "block";
  }

  function closeFormAdd() {
    document.getElementById("popup-form-add").style.display = "none";
  }

  function handleTableSelection() {
    document.getElementById("tableForm").submit();
  }
</script>
{% endblock %}
